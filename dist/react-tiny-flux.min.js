!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("immutable")):"function"==typeof define&&define.amd?define(["react","immutable"],e):t.ReactTinyFlux=e(t.React,t.immutable)}(this,function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;!function(){function t(t){this.value=t}function e(e){function n(o,i){try{var a=e[o](i),u=a.value;u instanceof t?Promise.resolve(u.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(a.done?"return":"normal",a.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(t,e){return new Promise(function(r,a){var u={key:t,arg:e,resolve:r,reject:a,next:null};i?i=i.next=u:(o=i=u,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}();var n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=function(){function t(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function(a){function u(){var t,r,o,a;n(this,u);for(var c=arguments.length,s=Array(c),f=0;c>f;f++)s[f]=arguments[f];return r=o=i(this,(t=u.__proto__||Object.getPrototypeOf(u)).call.apply(t,[this].concat(s))),o.state={data:e.fromJS(o.props.initial)},o.dispatch=function(t){var e=o.props.asyncActions;if(e[t.type])e[t.type](o.state.data,t,o.dispatch);else{var n=o.handleAction(o.state.data,t);o.setState({data:n})}},o.handleAction=function(t,e){var n=o.actions;if(e instanceof Array)return e.reduce(function(t,e){return o.handleAction(t,e)},t);var r=e.type;return n[r]?n[r](t,e):t},o.setState=o.setState.bind(o),a=r,i(o,a)}return o(u,t.Component),r(u,[{key:"render",value:function(){return this.props.children({_state:this.state,state:this.state.data,setState:this.setState,dispatch:this.dispatch})}}]),u}();return a.defaultProps={initial:{},asyncActions:{},actions:{}},a});
